<%= form_for @transaction, :html => { :method => :post } do %>
<h1>Transfer from <%= Location.find_by(id: @preroll.loc1).name %></h1>
<table class="u-full-width">
  <thead>
    <tr>
      <th>Transfer to</th>
      <th>Item</th>
      <th>Quantity</th>
    </tr>
  </thead>
  <tbody>
    <% @items.each do |item| %>
      <% if item.hassome(@preroll.loc1) %>
        <% transaction = Transaction.new(:item_id => item.id) %>
        <%= fields_for "transaction[]", transaction do |f| %>
          <tr class="form">
          <%= f.hidden_field :date, :value => @preroll.date %>
          <%= f.hidden_field :action_id, :value => '3' %>
          <%= f.hidden_field :loc1, :value => @preroll.loc1 %>
            <%= f.hidden_field :item_id, :value => item.id %>
            <td><%= f.collection_select(:loc2, @otherlocs, :id, :name, {:selected => @preroll.loc1}) %></td>
            <td><%= item.name_with_sub %></td>
          <td><%= f.number_field :quantity %></td>
          <td><%= item.remaining(@preroll.loc1) %></td>
          </tr>
        <% end %>
      <% else %>
      <% end %>
    <% end %>
  </tbody>
</table>

  <div class="actions">
    <%= submit_tag %>
  </div>
<% end %>